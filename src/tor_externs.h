extern int gzip_is_supported;
extern tor_mutex_t **_openssl_mutexes;
extern int _n_openssl_mutexes;
extern int _crypto_global_initialized;
extern BIGNUM *dh_param_p;
extern BIGNUM *dh_param_g;
extern int use_unsafe_renegotiation_op;
extern int use_unsafe_renegotiation_flag;
extern SSL_CIPHER *CLIENT_CIPHER_DUMMIES;
extern STACK_OF(SSL_CIPHER) *CLIENT_CIPHER_STACK;
extern struct tlsmap tlsmap_root;
extern tor_tls_context_t *global_tls_context;
extern int tls_library_is_initialized;
extern char ssl_state_buf[40];
extern int align;
extern size_t g_alignment;
extern pthread_mutex_t gen_mutex;
extern unsigned int malloc_started;
extern unsigned int malloc_cache;
extern struct pdinfo *last_dir;
extern struct pdinfo *prev_dir;
extern size_t pdi_off;
extern u_long pdi_mod;
extern u_long last_index;
extern struct pginfo **page_dir;
extern struct pgfree free_list;
extern int malloc_abort;
extern int suicide;
extern int malloc_silent;
extern int malloc_realloc;
extern int malloc_freeprot;
extern size_t malloc_guard;
extern size_t malloc_guarded;
extern int malloc_ptrguard;
extern int malloc_hint;
extern int malloc_xmalloc;
extern int malloc_zero;
extern int malloc_junk;
extern int malloc_utrace;
extern int malloc_active;
extern size_t malloc_used;
extern caddr_t malloc_brk;
extern struct pgfree *px;
extern int noprint;
extern int freelist_len;
extern memarea_chunk_t *freelist;
extern bitarray_t *open_sockets;
extern int max_socket;
extern int n_sockets_open;
extern tor_mutex_t *socket_accounting_mutex;
extern int have_already_switched_id;
extern char uname_result[256];
extern int uname_result_is_set;
extern tor_mutex_t *t_mut;
extern tor_mutex_t *gt_mut;
extern pthread_mutexattr_t attr_reentrant;
extern int threads_initialized;
extern int memory_lock_attempted;
extern unsigned long main_thread_id;
extern char fmt_addr_buf[TOR_ADDR_BUF_LEN];
extern char hex_str_buf[65];
extern char *_escaped_val;
extern time_t cached_approx_time;
extern int ftime_skew;
extern int ftime_slop;
extern int start_daemon_called;
extern int finish_daemon_called;
extern int daemon_filedes[2];
extern tor_mutex_t log_mutex;
extern int log_mutex_initialized;
extern logfile_t *logfiles;
extern int syslog_count;
extern char *appname;
extern int have_warned_about_unsafe_socks;
extern int num_cpuworkers;
extern int num_cpuworkers_busy;
extern time_t last_rotation_time;
extern event_mask_t global_event_mask;
extern int disable_log_messages;
extern int authentication_cookie_is_set;
extern char authentication_cookie[AUTHENTICATION_COOKIE_LEN];
extern char last_sent_bootstrap_message[BOOTSTRAP_MSG_LEN];
extern int bootstrap_percent;
extern int bootstrap_problems;
extern smartlist_t *geoip_countries;
extern strmap_t *country_idxplus1_by_lc_code;
extern smartlist_t *geoip_entries;
extern struct clientmap client_history;
extern time_t last_time_determined_shares;
extern double v2_share_times_seconds;
extern double v3_share_times_seconds;
extern int share_seconds;
extern uint32_t ns_v2_responses[GEOIP_NS_RESPONSE_NUM];
extern uint32_t ns_v3_responses[GEOIP_NS_RESPONSE_NUM];
extern int arrays_initialized;
extern struct dirreqmap dirreq_map;
extern time_t start_of_dirreq_stats_interval;
extern time_t start_of_bridge_stats_interval;
extern char *bridge_stats_extrainfo;
extern char *bridge_stats_controller;
extern time_t start_of_entry_stats_interval;
extern struct timeval cached_time_hires;
extern int num_seen;
extern uint64_t next_id;
extern int total_cells_allocated;
extern mp_pool_t *cell_pool;
extern mp_pool_t *it_pool;
extern double ewma_scale_factor;
extern int ewma_enabled;
extern smartlist_t *socks_policy;
extern smartlist_t *dir_policy;
extern smartlist_t *authdir_reject_policy;
extern smartlist_t *authdir_invalid_policy;
extern smartlist_t *authdir_baddir_policy;
extern smartlist_t *authdir_badexit_policy;
extern smartlist_t *reachable_or_addr_policy;
extern smartlist_t *reachable_dir_addr_policy;
extern struct policy_map policy_root;
extern voting_schedule_t voting_schedule;
extern smartlist_t *pending_vote_list;
extern smartlist_t *previous_vote_list;
extern pending_consensus_t pending_consensuses[N_CONSENSUS_FLAVORS];
extern char *pending_consensus_signatures;
extern smartlist_t *pending_consensus_signature_list;
extern char *microdesc_consensus_methods;
extern int stats_prev_global_read_bucket;
extern int stats_prev_global_write_bucket;
extern uint64_t stats_n_bytes_read;
extern uint64_t stats_n_bytes_written;
extern time_t time_to_check_for_correct_dns;
extern time_t time_of_last_signewnym;
extern int signewnym_is_pending;
extern smartlist_t *connection_array;
extern smartlist_t *closeable_connection_lst;
extern smartlist_t *active_linked_connection_lst;
extern int called_loop_once;
extern time_t last_rotated_x509_certificate;
extern time_t time_to_check_v3_certificate;
extern time_t time_to_check_listeners;
extern time_t time_to_check_descriptor;
extern time_t time_to_check_ipaddress;
extern time_t time_to_shrink_memory;
extern time_t time_to_try_getting_descriptors;
extern time_t time_to_reset_descriptor_failures;
extern time_t time_to_add_entropy;
extern time_t time_to_write_bridge_status_file;
extern time_t time_to_downrate_stability;
extern time_t time_to_save_stability;
extern time_t time_to_clean_caches;
extern time_t time_to_recheck_bandwidth;
extern time_t time_to_check_for_expired_networkstatus;
extern time_t time_to_write_stats_files;
extern time_t time_to_write_bridge_stats;
extern int should_init_bridge_stats;
extern time_t time_to_retry_dns_init;
extern int dirport_reachability_count;
extern periodic_timer_t *second_timer;
extern int n_libevent_errors;
extern time_t cur_sec_elap;
extern struct event *signal_events[16];
extern tor_lockfile_t *lockfile;
extern smartlist_t *entry_guards;
extern int entry_guards_dirty;
extern int unit_tests;
extern int should_add_entry_nodes;
extern smartlist_t *bridge_list;
extern smartlist_t *rend_service_list;
extern int consider_republishing_rend_descriptors;
extern struct timeval exit_now;
extern smartlist_t *circuits_pending_or_conns;
extern struct orconn_circid_map orconn_circid_circuit_map;
extern char circ_state_buf[64];
extern char circ_purp_buf[32];
extern uint32_t n_circuits_allocated;
extern strmap_t *rend_cache;
extern digestmap_t *rend_cache_v2_dir;
extern uint32_t last_interface_ip;
extern smartlist_t *outgoing_addrs;
extern char conn_type_buf[64];
extern char conn_st_buf[96];
extern uint64_t n_connections_allocated;
extern time_t last_conn_warning;
extern int write_buckets_empty_last_second;
extern hibernate_state_t hibernate_state;
extern time_t hibernate_end_time;
extern time_t shutdown_time;
extern uint64_t n_bytes_read_in_interval;
extern uint64_t n_bytes_written_in_interval;
extern uint32_t n_seconds_active_in_interval;
extern time_t interval_start_time;
extern time_t interval_end_time;
extern time_t interval_wakeup_time;
extern uint64_t expected_bandwidth_usage;
extern time_unit_t cfg_unit;
extern int cfg_start_day;
extern int cfg_start_hour;
extern int cfg_start_min;
extern uint64_t last_read_bytes_noted;
extern uint64_t last_written_bytes_noted;
extern time_t last_time_noted;
extern struct evdns_base *the_evdns_base;
extern int nameservers_configured;
extern int nameserver_config_failed;
extern char *resolv_conf_fname;
extern time_t resolv_conf_mtime;
extern struct cache_map cache_root;
extern int all_down;
extern smartlist_t *cached_resolve_pqueue;
extern int n_wildcard_requests;
extern strmap_t *dns_wildcard_response_count;
extern smartlist_t *dns_wildcard_list;
extern int dns_wildcard_one_notice_given;
extern int dns_wildcard_notice_given;
extern smartlist_t *dns_wildcarded_test_address_list;
extern int dns_wildcarded_test_address_notice_given;
extern int dns_is_completely_invalid;
extern struct event *launch_event;
extern strmap_t *addressmap;
extern strmap_t *virtaddress_reversemap;
extern uint32_t virtual_addr_network;
extern maskbits_t virtual_addr_netmask_bits;
extern uint32_t next_virtual_addr;
extern int pf_socket;
extern token_rule_t routerdesc_token_table[26];
extern token_rule_t extrainfo_token_table[31];
extern token_rule_t rtrstatus_token_table[8];
extern token_rule_t netstatus_token_table[11];
extern token_rule_t dir_footer_token_table[2];
extern token_rule_t dir_token_table[12];
extern token_rule_t dir_key_certificate_table[2];
extern token_rule_t desc_token_table[9];
extern token_rule_t ipo_token_table[6];
extern token_rule_t client_keys_token_table[4];
extern token_rule_t networkstatus_token_table[19];
extern token_rule_t networkstatus_consensus_token_table[16];
extern token_rule_t networkstatus_vote_footer_token_table[4];
extern token_rule_t networkstatus_detached_signature_token_table[8];
extern token_rule_t microdesc_token_table[5];
extern time_t last_desc_dumped;
extern digestmap_t *verified_digests;
extern time_t stability_last_downrated;
extern time_t started_tracking_stability;
extern digestmap_t *history_map;
extern char *last_stability_doc;
extern time_t built_last_stability_doc_at;
extern int n_bogus_times;
extern bw_array_t *read_array;
extern bw_array_t *write_array;
extern bw_array_t *dir_read_array;
extern bw_array_t *dir_write_array;
extern smartlist_t *predicted_ports_list;
extern smartlist_t *predicted_ports_times;
extern time_t predicted_internal_time;
extern time_t predicted_internal_uptime_time;
extern time_t predicted_internal_capacity_time;
extern pk_op_counts_t pk_op_counts;
extern uint64_t *exit_bytes_read;
extern uint64_t *exit_bytes_written;
extern uint32_t *exit_streams;
extern time_t start_of_exit_stats_interval;
extern time_t start_of_buffer_stats_interval;
extern smartlist_t *trusted_dir_servers;
extern digestmap_t *trusted_dir_certs;
extern int trusted_dir_servers_certs_changed;
extern routerlist_t *routerlist;
extern smartlist_t *warned_nicknames;
extern time_t last_routerdesc_download_attempted;
extern uint64_t sl_last_total_weighted_bw;
extern uint64_t sl_last_weighted_bw_of_me;
extern time_t last_dummy_download;
extern int have_min_dir_info;
extern int need_to_update_have_min_dir_info;
extern char dir_info_status[128];
extern char *info;
extern int num_create;
extern int create_time;
extern time_t curr_sec;
extern int num_versions;
extern config_abbrev_t _option_abbrevs[38];
extern config_abbrev_t _state_abbrevs[9];
extern config_var_t _option_vars[224];
extern config_var_t testing_tor_network_defaults[17];
extern config_var_t _state_vars[30];
extern config_format_t options_format;
extern config_var_t state_extra_var;
extern config_format_t state_format;
extern or_options_t *global_options;
extern char *torrc_fname;
extern or_state_t *global_state;
extern config_line_t *global_cmdline_options;
extern char *global_dirfrontpagecontents;
extern char *_version;
extern int libevent_initialized;
extern uint32_t last_resolved_addr;
extern char **backup_argv;
extern int backup_argc;
extern struct unit_table_t memory_units[25];
extern struct unit_table_t time_units[13];
extern digestmap_t *v2_download_status_map;
extern smartlist_t *networkstatus_v2_list;
extern int networkstatus_v2_list_has_changed;
extern strmap_t *named_server_map;
extern strmap_t *unnamed_server_map;
extern networkstatus_t *current_consensus;
extern consensus_waiting_for_certs_t       consensus_waiting_for_certs[N_CONSENSUS_FLAVORS];
extern time_t last_networkstatus_download_attempted;
extern time_t time_to_download_next_consensus;
extern download_status_t consensus_dl_status[N_CONSENSUS_FLAVORS];
extern int have_warned_about_old_version;
extern int have_warned_about_new_version;
extern digestmap_t *orconn_identity_map;
extern onion_queue_t *ol_list;
extern onion_queue_t *ol_tail;
extern int ol_length;
extern time_t last_circ_warning;
extern time_t time_to_new_circuit;
extern int have_performed_bandwidth_test;
extern int n_circuit_failures;
extern int did_circs_fail_last_period;
extern tor_mutex_t *key_lock;
extern time_t onionkey_set_at;
extern crypto_pk_env_t *onionkey;
extern crypto_pk_env_t *lastonionkey;
extern crypto_pk_env_t *identitykey;
extern char identitykey_digest[DIGEST_LEN];
extern crypto_pk_env_t *authority_signing_key;
extern authority_cert_t *authority_key_certificate;
extern crypto_pk_env_t *legacy_signing_key;
extern authority_cert_t *legacy_key_certificate;
extern time_t last_exp_warning;
extern int can_reach_or_port;
extern int can_reach_dir_port;
extern int advertising;
extern int server_is_advertised;
extern routerinfo_t *desc_routerinfo;
extern extrainfo_t *desc_extrainfo;
extern time_t desc_clean_since;
extern int desc_needs_upload;
extern smartlist_t *warned_nonexistent_family;
extern time_t last_changed;
extern uint32_t last_guessed_ip;
extern int write_stats_to_extrainfo;
extern strmap_t *last_hid_serv_requests;
extern strmap_t *auth_hid_servs;
extern strmap_t *request_map;
extern microdesc_cache_t *the_microdesc_cache;
extern time_t the_directory_is_dirty;
extern time_t runningrouters_is_dirty;
extern time_t the_v2_networkstatus_is_dirty;
extern cached_dir_t *the_directory;
extern cached_dir_t the_runningrouters;
extern authdir_config_t *fingerprint_list;
extern cached_dir_t *cached_directory;
extern cached_dir_t cached_runningrouters;
extern digestmap_t *cached_v2_networkstatus;
extern strmap_t *cached_consensuses;
extern cached_dir_t *the_v2_networkstatus;
extern uint32_t stable_uptime;
extern double stable_mtbf;
extern int enough_mtbf_info;
extern double guard_wfu;
extern long guard_tk;
extern uint32_t fast_bandwidth;
extern uint32_t guard_bandwidth_including_exits;
extern uint32_t guard_bandwidth_excluding_exits;
extern uint64_t total_bandwidth;
extern uint64_t total_exit_bandwidth;
extern char ctr;
extern int global_read_bucket;
extern int global_write_bucket;

extern int created_time;
extern int destroy_time;
extern struct chunk_freelist_t freelists[5];
extern uint64_t n_freelist_miss;
extern int num_cert;
extern int num_created;
extern int num_destroy;
extern int num_relay;
extern int relay_time;
extern circuit_build_times_t circ_times;
extern struct orconn_circid_circuit_map_t *_last_circid_orconn_ent;
extern circuit_t *global_circuitlist;
extern uint64_t stats_n_create_cells_processed;
extern uint64_t stats_n_created_cells_processed;
extern uint64_t stats_n_destroy_cells_processed;
extern uint64_t stats_n_netinfo_cells_processed;
extern uint64_t stats_n_padding_cells_processed;
extern uint64_t stats_n_relay_cells_processed;
extern uint64_t stats_n_versions_cells_processed;
extern int global_relayed_read_bucket;
extern int global_relayed_write_bucket;
extern int has_completed_circuit;
extern long stats_n_seconds_working;
extern time_t time_of_process_start;
extern uint64_t stats_n_data_bytes_packaged;
extern uint64_t stats_n_data_bytes_received;
extern uint64_t stats_n_data_cells_packaged;
extern uint64_t stats_n_data_cells_received;
extern uint64_t stats_n_relay_cells_delivered;
extern uint64_t stats_n_relay_cells_relayed;
extern smartlist_t *circuits_for_buffer_stats;
extern uint64_t rephist_total_alloc;
extern uint32_t rephist_total_num;
extern int _log_global_min_severity;
extern struct event_base *the_event_base;

extern struct event_base * current_vev_base;
